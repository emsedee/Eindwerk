/*
Deployment script for DatabaseEindWerk

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "DatabaseEindWerk"
:setvar DefaultFilePrefix "DatabaseEindWerk"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Rename refactoring operation with key bd8b3689-a0e9-4fbd-a209-687352d97d5a is skipped, element [dbo].[Prioriteit].[Gewoon] (SqlSimpleColumn) will not be renamed to _prioriteit';


GO
PRINT N'Creating [dbo].[Bestelde onderdelen]...';


GO
CREATE TABLE [dbo].[Bestelde onderdelen] (
    [Bestel_id]                  INT           IDENTITY (1, 1) NOT NULL,
    [Onderdeel_id]               INT           NOT NULL,
    [Onderdelencode_leverancier] VARCHAR (MAX) NULL,
    [Aantal]                     INT           NULL,
    PRIMARY KEY CLUSTERED ([Onderdeel_id] ASC, [Bestel_id] ASC)
);


GO
PRINT N'Creating [dbo].[Bestellingen]...';


GO
CREATE TABLE [dbo].[Bestellingen] (
    [Bestel_id]       INT        IDENTITY (1, 1) NOT NULL,
    [Besteldatum]     NCHAR (10) NULL,
    [LeveringsDatum]  NCHAR (10) NULL,
    [Leveranciers_id] INT        NOT NULL,
    [Personeels_id]   INT        NOT NULL,
    [Factuur_id]      INT        NOT NULL,
    [Interventie_id]  INT        NOT NULL,
    PRIMARY KEY CLUSTERED ([Bestel_id] ASC)
);


GO
PRINT N'Creating [dbo].[Betrokkenheid]...';


GO
CREATE TABLE [dbo].[Betrokkenheid] (
    [Interventie_id] INT      IDENTITY (1, 1) NOT NULL,
    [Personeels_id]  INT      NOT NULL,
    [Begin]          DATETIME NULL,
    [Einde]          DATETIME NULL,
    PRIMARY KEY CLUSTERED ([Interventie_id] ASC, [Personeels_id] ASC)
);


GO
PRINT N'Creating [dbo].[Competentie]...';


GO
CREATE TABLE [dbo].[Competentie] (
    [Personeels_id]    INT        IDENTITY (1, 1) NOT NULL,
    [Specialisatie_id] INT        NOT NULL,
    [Niveau]           NCHAR (10) NULL,
    [Niveau_id]        INT        NULL,
    [Datum verworven]  DATETIME   NULL,
    PRIMARY KEY CLUSTERED ([Personeels_id] ASC, [Specialisatie_id] ASC)
);


GO
PRINT N'Creating [dbo].[Facturen]...';


GO
CREATE TABLE [dbo].[Facturen] (
    [Factuur_id]  INT      IDENTITY (1, 1) NOT NULL,
    [Datum]       DATETIME NULL,
    [VervalDatum] DATETIME NULL,
    PRIMARY KEY CLUSTERED ([Factuur_id] ASC)
);


GO
PRINT N'Creating [dbo].[Fotos]...';


GO
CREATE TABLE [dbo].[Fotos] (
    [Foto_id]        INT   IDENTITY (1, 1) NOT NULL,
    [Interventie_id] INT   NOT NULL,
    [image]          IMAGE NULL,
    PRIMARY KEY CLUSTERED ([Foto_id] ASC)
);


GO
PRINT N'Creating [dbo].[Interventie competenties]...';


GO
CREATE TABLE [dbo].[Interventie competenties] (
    [Interventie_id]   INT NOT NULL,
    [Personeels_id]    INT NOT NULL,
    [Specialisatie_id] INT NOT NULL,
    PRIMARY KEY CLUSTERED ([Interventie_id] ASC, [Specialisatie_id] ASC, [Personeels_id] ASC)
);


GO
PRINT N'Creating [dbo].[Interventies]...';


GO
CREATE TABLE [dbo].[Interventies] (
    [Interventie_id]              INT           IDENTITY (1, 1) NOT NULL,
    [Complexiteit]                VARCHAR (50)  NULL,
    [Meldingsdatum]               DATETIME      NULL,
    [Omschrijving]                VARCHAR (MAX) NULL,
    [Einddatum]                   DATETIME      NULL,
    [duur]                        DATETIME      NULL,
    [Verwachtteoplossingstermijn] DATETIME      NULL,
    [Omschrijving oplossing]      VARCHAR (MAX) NULL,
    [Personeels_id]               INT           NULL,
    [Prioriteit_id]               INT           NULL,
    [Toestel_id]                  INT           NULL,
    [Bestel_id]                   INT           NULL,
    [Soort interventie]           NVARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Interventie_id] ASC)
);


GO
PRINT N'Creating [dbo].[Kennisgebieden]...';


GO
CREATE TABLE [dbo].[Kennisgebieden] (
    [Specialisatie_id]   INT           IDENTITY (1, 1) NOT NULL,
    [Korte omschrijving] VARCHAR (50)  NULL,
    [Lange omschrijving] VARCHAR (MAX) NULL,
    [Soort kennisgebied] NCHAR (10)    NULL,
    PRIMARY KEY CLUSTERED ([Specialisatie_id] ASC)
);


GO
PRINT N'Creating [dbo].[Leverancier]...';


GO
CREATE TABLE [dbo].[Leverancier] (
    [Leveranciers_id] INT           IDENTITY (1, 1) NOT NULL,
    [Naam]            VARCHAR (50)  NULL,
    [Telefoon]        VARCHAR (50)  NULL,
    [Email]           VARCHAR (50)  NULL,
    [Website]         VARCHAR (MAX) NULL,
    [Straat]          VARCHAR (50)  NULL,
    [Huisnummer]      VARCHAR (50)  NULL,
    [Postcode]        VARCHAR (50)  NULL,
    [Stad]            VARCHAR (50)  NULL,
    PRIMARY KEY CLUSTERED ([Leveranciers_id] ASC)
);


GO
PRINT N'Creating [dbo].[Locatie]...';


GO
CREATE TABLE [dbo].[Locatie] (
    [Locatie_id]       INT        IDENTITY (1, 1) NOT NULL,
    [VoorraadPlaatsen] NCHAR (10) NULL,
    [Oppervlakte]      NCHAR (10) NULL,
    [Soort Ruimte]     NCHAR (10) NULL,
    PRIMARY KEY CLUSTERED ([Locatie_id] ASC)
);


GO
PRINT N'Creating [dbo].[Niveau]...';


GO
CREATE TABLE [dbo].[Niveau] (
    [Niveau_id] INT          IDENTITY (1, 1) NOT NULL,
    [Beginner]  VARCHAR (50) NULL,
    [Ervaren]   VARCHAR (50) NULL,
    [Expert]    VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Niveau_id] ASC)
);


GO
PRINT N'Creating [dbo].[Onderdelen]...';


GO
CREATE TABLE [dbo].[Onderdelen] (
    [Toestel_id]         INT           NOT NULL,
    [Onderdeel_id]       INT           NOT NULL,
    [Kleur]              VARCHAR (50)  NULL,
    [Omschrijving]       VARCHAR (MAX) NULL,
    [Formaat]            INT           NULL,
    [Gewicht]            INT           NULL,
    [Parentonderdeel_ID] INT           NULL,
    PRIMARY KEY CLUSTERED ([Toestel_id] ASC, [Onderdeel_id] ASC)
);


GO
PRINT N'Creating [dbo].[Onderdelencode]...';


GO
CREATE TABLE [dbo].[Onderdelencode] (
    [Leveranciers_id]            INT            NOT NULL,
    [Onderdeel_id]               INT            NOT NULL,
    [Onderdelencode_leverancier] NVARCHAR (MAX) NULL,
    [Aankoopprijs]               INT            NULL,
    PRIMARY KEY CLUSTERED ([Leveranciers_id] ASC, [Onderdeel_id] ASC)
);


GO
PRINT N'Creating [dbo].[Personeelsleden]...';


GO
CREATE TABLE [dbo].[Personeelsleden] (
    [Personeels_id]       INT            IDENTITY (1, 1) NOT NULL,
    [Naam]                VARCHAR (50)   NULL,
    [Voornaam]            VARCHAR (50)   NULL,
    [Gsm Nummer]          NVARCHAR (MAX) NULL,
    [Emailadres]          NVARCHAR (MAX) NULL,
    [Foto]                IMAGE          NULL,
    [Soort Personeelslid] NVARCHAR (50)  NULL,
    PRIMARY KEY CLUSTERED ([Personeels_id] ASC)
);


GO
PRINT N'Creating [dbo].[Prioriteit]...';


GO
CREATE TABLE [dbo].[Prioriteit] (
    [Prioriteit_id] INT        IDENTITY (1, 1) NOT NULL,
    [_prioriteit]   NCHAR (10) NULL,
    PRIMARY KEY CLUSTERED ([Prioriteit_id] ASC)
);


GO
PRINT N'Creating [dbo].[Tablet]...';


GO
CREATE TABLE [dbo].[Tablet] (
    [Tablet_id]          INT          IDENTITY (1, 1) NOT NULL,
    [Prijs]              INT          NULL,
    [Merk]               VARCHAR (50) NULL,
    [BesturingsSysteeem] VARCHAR (50) NULL,
    [SchermType]         VARCHAR (50) NULL,
    [Resolutie]          INT          NULL,
    PRIMARY KEY CLUSTERED ([Tablet_id] ASC)
);


GO
PRINT N'Creating [dbo].[TabletPersoneelsLeden]...';


GO
CREATE TABLE [dbo].[TabletPersoneelsLeden] (
    [Tablet_id]     INT NOT NULL,
    [Personeels_id] INT NOT NULL,
    PRIMARY KEY CLUSTERED ([Tablet_id] ASC, [Personeels_id] ASC)
);


GO
PRINT N'Creating [dbo].[Toestel]...';


GO
CREATE TABLE [dbo].[Toestel] (
    [Toestel_id]        INT           IDENTITY (1, 1) NOT NULL,
    [Naam]              VARCHAR (50)  NULL,
    [Merk]              VARCHAR (50)  NULL,
    [Keuring]           DATETIME      NULL,
    [Ouderdom]          INT           NULL,
    [Omschrijving]      VARCHAR (MAX) NULL,
    [Formaat]           INT           NULL,
    [Maximum gewicht]   INT           NULL,
    [Type matras]       VARCHAR (50)  NULL,
    [Type aandrijving]  VARCHAR (50)  NULL,
    [Opplooibaar]       BIT           NULL,
    [Verstelbaar]       BIT           NULL,
    [Materie]           VARCHAR (50)  NULL,
    [DatumAfschrijving] DATETIME      NULL,
    [Locatie_id]        INT           NULL,
    [Soort toestel]     NVARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Toestel_id] ASC)
);


GO
PRINT N'Creating [dbo].[Voorraad]...';


GO
CREATE TABLE [dbo].[Voorraad] (
    [Onderdeel_id] INT NOT NULL,
    [Locatie_id]   INT NOT NULL,
    [Aantal]       INT NULL,
    PRIMARY KEY CLUSTERED ([Onderdeel_id] ASC, [Locatie_id] ASC)
);


GO
PRINT N'Creating [dbo].[FK_Bestellingen_Leverancier]...';


GO
ALTER TABLE [dbo].[Bestellingen] WITH NOCHECK
    ADD CONSTRAINT [FK_Bestellingen_Leverancier] FOREIGN KEY ([Leveranciers_id]) REFERENCES [dbo].[Leverancier] ([Leveranciers_id]);


GO
PRINT N'Creating [dbo].[FK_Bestellingen_Personeelsleden]...';


GO
ALTER TABLE [dbo].[Bestellingen] WITH NOCHECK
    ADD CONSTRAINT [FK_Bestellingen_Personeelsleden] FOREIGN KEY ([Personeels_id]) REFERENCES [dbo].[Personeelsleden] ([Personeels_id]);


GO
PRINT N'Creating [dbo].[FK_Bestellingen_Facturen]...';


GO
ALTER TABLE [dbo].[Bestellingen] WITH NOCHECK
    ADD CONSTRAINT [FK_Bestellingen_Facturen] FOREIGN KEY ([Factuur_id]) REFERENCES [dbo].[Facturen] ([Factuur_id]);


GO
PRINT N'Creating [dbo].[FK_Bestellingen_Interventies]...';


GO
ALTER TABLE [dbo].[Bestellingen] WITH NOCHECK
    ADD CONSTRAINT [FK_Bestellingen_Interventies] FOREIGN KEY ([Interventie_id]) REFERENCES [dbo].[Interventies] ([Interventie_id]);


GO
PRINT N'Creating [dbo].[FK_Competentie_Niveau]...';


GO
ALTER TABLE [dbo].[Competentie] WITH NOCHECK
    ADD CONSTRAINT [FK_Competentie_Niveau] FOREIGN KEY ([Niveau_id]) REFERENCES [dbo].[Niveau] ([Niveau_id]);


GO
PRINT N'Creating [dbo].[FK_Fotos_Interventies]...';


GO
ALTER TABLE [dbo].[Fotos] WITH NOCHECK
    ADD CONSTRAINT [FK_Fotos_Interventies] FOREIGN KEY ([Interventie_id]) REFERENCES [dbo].[Interventies] ([Interventie_id]);


GO
PRINT N'Creating [dbo].[FK_Interventie competenties_Interventies]...';


GO
ALTER TABLE [dbo].[Interventie competenties] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventie competenties_Interventies] FOREIGN KEY ([Interventie_id]) REFERENCES [dbo].[Interventies] ([Interventie_id]);


GO
PRINT N'Creating [dbo].[FK_Interventie competenties_Personeelsleden]...';


GO
ALTER TABLE [dbo].[Interventie competenties] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventie competenties_Personeelsleden] FOREIGN KEY ([Personeels_id]) REFERENCES [dbo].[Personeelsleden] ([Personeels_id]);


GO
PRINT N'Creating [dbo].[FK_Interventie competenties_Kennisgebieden]...';


GO
ALTER TABLE [dbo].[Interventie competenties] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventie competenties_Kennisgebieden] FOREIGN KEY ([Specialisatie_id]) REFERENCES [dbo].[Kennisgebieden] ([Specialisatie_id]);


GO
PRINT N'Creating [dbo].[FK_Interventies_Personeelsleden]...';


GO
ALTER TABLE [dbo].[Interventies] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventies_Personeelsleden] FOREIGN KEY ([Personeels_id]) REFERENCES [dbo].[Personeelsleden] ([Personeels_id]);


GO
PRINT N'Creating [dbo].[FK_Interventies_Prioriteit]...';


GO
ALTER TABLE [dbo].[Interventies] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventies_Prioriteit] FOREIGN KEY ([Prioriteit_id]) REFERENCES [dbo].[Prioriteit] ([Prioriteit_id]);


GO
PRINT N'Creating [dbo].[FK_Interventies_Toestel]...';


GO
ALTER TABLE [dbo].[Interventies] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventies_Toestel] FOREIGN KEY ([Toestel_id]) REFERENCES [dbo].[Toestel] ([Toestel_id]);


GO
PRINT N'Creating [dbo].[FK_Interventies_Bestellingen]...';


GO
ALTER TABLE [dbo].[Interventies] WITH NOCHECK
    ADD CONSTRAINT [FK_Interventies_Bestellingen] FOREIGN KEY ([Bestel_id]) REFERENCES [dbo].[Bestellingen] ([Bestel_id]);


GO
PRINT N'Creating [dbo].[FK_Onderdelen_Toestel]...';


GO
ALTER TABLE [dbo].[Onderdelen] WITH NOCHECK
    ADD CONSTRAINT [FK_Onderdelen_Toestel] FOREIGN KEY ([Toestel_id]) REFERENCES [dbo].[Toestel] ([Toestel_id]);


GO
PRINT N'Creating [dbo].[FK_TabletPersoneelsLeden_Tablet]...';


GO
ALTER TABLE [dbo].[TabletPersoneelsLeden] WITH NOCHECK
    ADD CONSTRAINT [FK_TabletPersoneelsLeden_Tablet] FOREIGN KEY ([Tablet_id]) REFERENCES [dbo].[Tablet] ([Tablet_id]);


GO
PRINT N'Creating [dbo].[FK_TabletPersoneelsLeden_Personeelsleden]...';


GO
ALTER TABLE [dbo].[TabletPersoneelsLeden] WITH NOCHECK
    ADD CONSTRAINT [FK_TabletPersoneelsLeden_Personeelsleden] FOREIGN KEY ([Personeels_id]) REFERENCES [dbo].[Personeelsleden] ([Personeels_id]);


GO
PRINT N'Creating [dbo].[FK_Toestel_Locatie]...';


GO
ALTER TABLE [dbo].[Toestel] WITH NOCHECK
    ADD CONSTRAINT [FK_Toestel_Locatie] FOREIGN KEY ([Locatie_id]) REFERENCES [dbo].[Locatie] ([Locatie_id]);


GO
-- Refactoring step to update target server with deployed transaction logs
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'bd8b3689-a0e9-4fbd-a209-687352d97d5a')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('bd8b3689-a0e9-4fbd-a209-687352d97d5a')

GO

GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[Bestellingen] WITH CHECK CHECK CONSTRAINT [FK_Bestellingen_Leverancier];

ALTER TABLE [dbo].[Bestellingen] WITH CHECK CHECK CONSTRAINT [FK_Bestellingen_Personeelsleden];

ALTER TABLE [dbo].[Bestellingen] WITH CHECK CHECK CONSTRAINT [FK_Bestellingen_Facturen];

ALTER TABLE [dbo].[Bestellingen] WITH CHECK CHECK CONSTRAINT [FK_Bestellingen_Interventies];

ALTER TABLE [dbo].[Competentie] WITH CHECK CHECK CONSTRAINT [FK_Competentie_Niveau];

ALTER TABLE [dbo].[Fotos] WITH CHECK CHECK CONSTRAINT [FK_Fotos_Interventies];

ALTER TABLE [dbo].[Interventie competenties] WITH CHECK CHECK CONSTRAINT [FK_Interventie competenties_Interventies];

ALTER TABLE [dbo].[Interventie competenties] WITH CHECK CHECK CONSTRAINT [FK_Interventie competenties_Personeelsleden];

ALTER TABLE [dbo].[Interventie competenties] WITH CHECK CHECK CONSTRAINT [FK_Interventie competenties_Kennisgebieden];

ALTER TABLE [dbo].[Interventies] WITH CHECK CHECK CONSTRAINT [FK_Interventies_Personeelsleden];

ALTER TABLE [dbo].[Interventies] WITH CHECK CHECK CONSTRAINT [FK_Interventies_Prioriteit];

ALTER TABLE [dbo].[Interventies] WITH CHECK CHECK CONSTRAINT [FK_Interventies_Toestel];

ALTER TABLE [dbo].[Interventies] WITH CHECK CHECK CONSTRAINT [FK_Interventies_Bestellingen];

ALTER TABLE [dbo].[Onderdelen] WITH CHECK CHECK CONSTRAINT [FK_Onderdelen_Toestel];

ALTER TABLE [dbo].[TabletPersoneelsLeden] WITH CHECK CHECK CONSTRAINT [FK_TabletPersoneelsLeden_Tablet];

ALTER TABLE [dbo].[TabletPersoneelsLeden] WITH CHECK CHECK CONSTRAINT [FK_TabletPersoneelsLeden_Personeelsleden];

ALTER TABLE [dbo].[Toestel] WITH CHECK CHECK CONSTRAINT [FK_Toestel_Locatie];


GO
PRINT N'Update complete.';


GO
